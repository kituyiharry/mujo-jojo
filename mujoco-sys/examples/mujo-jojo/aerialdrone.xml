<mujoco model="Skydio Drone">
    <compiler autolimits="true" assetdir="assets"/>
    <option timestep="0.01" density="1.225" viscosity="1.8e-5">
        <flag contact="enable"/>
    </option>

    <statistic center="0 0 0.1" extent="0.6" meansize=".05"/>

    <default>
        <default class="x2">
            <geom mass="0"/>
            <motor ctrlrange="0 13"/>
            <mesh scale="0.01 0.01 0.01"/>
            <default class="visual">
                <geom group="2" type="mesh" contype="0" conaffinity="0"/>
            </default>
            <default class="collision">
                <geom group="3" type="box"/>
                <default class="rotor">
                    <geom type="ellipsoid" size=".13 .13 .01"/>
                </default>
            </default>
            <site group="5"/>
        </default>
    </default>

    <asset>
        <texture  name="grid" type="2d" builtin="checker" width="512" height="512" rgb1=".1 .2 .3" rgb2=".2 .3 .4"/>
        <material name="grid" texture="grid" texrepeat="1 1" texuniform="true" reflectance=".2"/>
        <!-- sets the sky -->
        <texture  name="skybox" type="skybox" builtin="gradient" rgb1=".3 .5 .7" rgb2="0 0 0" width="512" height="512"/>
        <texture type="2d" file="X2_lowpoly_texture_SpinningProps_1024.png"/>
        <material name="phong3SG" texture="X2_lowpoly_texture_SpinningProps_1024"/>
        <material name="invisible" rgba="0 0 0 0"/>
        <mesh class="x2" file="X2_lowpoly.obj"/>

        <!--<texture type="skybox" builtin="gradient" rgb1="0.3 0.5 0.7" rgb2="0 0 0" width="512" height="3072"/>-->
        <texture type="2d" name="groundplane" builtin="checker" mark="edge" rgb1="0.2 0.3 0.4" rgb2="0.1 0.2 0.3"
            markrgb="0.8 0.8 0.8" width="300" height="300"/>
        <material name="groundplane" texture="groundplane" texuniform="true" texrepeat="5 5" reflectance="0.2"/>
    </asset>

    <worldbody>

        <light pos="0 0 1.5" dir="0 0 -1" directional="true"/>
        <geom name="floor" size="0 0 0.05" type="plane" material="groundplane"/>

        <light name="spotlight" mode="targetbodycom" target="x2" pos="0 -1 2"/>

        <geom name="red_box" type="box" pos="4.0 3.5 0.0" size="3.2 3.2 3.2" rgba="1 0 0 1"/>
        <geom name="green_sphere"       pos="-4.0 -3.5 0.0" size="3.1" rgba="0 1 0 1"/>

        <body name="x2" pos="0 0 0.1" childclass="x2">
            <freejoint/>
            <inertial pos="0 0 0" mass="0.2" diaginertia="0.002 0.002 0.004"/>
            <!-- video stream camera (mujoco camera sensor isn't a real simulated sensor - just copied pixels ??)
                see:  https://github.com/google-deepmind/mujoco/discussions/688
                also: https://github.com/google-deepmind/mujoco/discussions/1726#discussioncomment-9719059
            -->
            <camera name="stream" pos="0 0 .2" euler="0 90 90" />
            <camera name="track"  pos="-1 0 .5" xyaxes="0 -1 0 1 0 2" mode="trackcom"/>
            <site name="imu" pos="0 0 .02"/>
            <geom material="phong3SG" mesh="X2_lowpoly" class="visual" quat="0 0 1 1"/>
            <geom class="collision" size=".06 .027 .02"  pos=".04 0 .02"/>
            <geom class="collision" size=".06 .027 .02"  pos=".04 0 .06"/>
            <geom class="collision" size=".05 .027 .02"  pos="-.07 0 .065"/>
            <geom class="collision" size=".023 .017 .01" pos="-.137 .008 .065" quat="1 0 0 1"/>
            <geom name="rotor1" class="rotor" pos="-.14 -.18 .05" mass=".25"/>
            <geom name="rotor2" class="rotor" pos="-.14 .18 .05" mass=".25"/>
            <geom name="rotor3" class="rotor" pos=".14 .18 .08" mass=".25"/>
            <geom name="rotor4" class="rotor" pos=".14 -.18 .08" mass=".25"/>
            <geom size=".16 .04 .02" pos="0 0 0.02" type="ellipsoid" mass=".325" class="visual" material="invisible"/>
            <site name="thrust1" pos="-.14 -.18 .05"/>
            <site name="thrust2" pos="-.14  .18 .05"/>
            <site name="thrust3" pos=" .14  .18 .08"/>
            <site name="thrust4" pos=" .14 -.18 .08"/>
        </body>
    </worldbody>

    <actuator>
        <motor class="x2" name="thrust1" site="thrust1" gear="0 0 1 0 0 .0201"/>
        <motor class="x2" name="thrust2" site="thrust2" gear="0 0 1 0 0 -.0201"/>
        <motor class="x2" name="thrust3" site="thrust3" gear="0 0 1 0 0 .0201"/>
        <motor class="x2" name="thrust4" site="thrust4" gear="0 0 1 0 0 -.0201"/>
    </actuator>

    <sensor>
        <gyro name="body_gyro" site="imu"/>
        <accelerometer name="body_linacc" site="imu"/>
        <framequat name="body_quat" objtype="site" objname="imu"/>
    </sensor>

    <keyframe>
        <key name="hover" qpos="0 0 .3 1 0 0 0" ctrl="3.2495625 3.2495625 3.2495625 3.2495625"/>
    </keyframe>

    <visual>
        <headlight diffuse="0.8 0.8 0.8" ambient="0.3 0.3 0.3" specular="0 0 0"/>
        <rgba haze="0.15 0.25 0.35 1"/>
        <global azimuth="-20" elevation="-20" ellipsoidinertia="true"/>
    </visual>

</mujoco>
